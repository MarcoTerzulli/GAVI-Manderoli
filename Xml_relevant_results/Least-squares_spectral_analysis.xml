<mediawiki xmlns="http://www.mediawiki.org/xml/export-0.10/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mediawiki.org/xml/export-0.10/ http://www.mediawiki.org/xml/export-0.10.xsd" version="0.10" xml:lang="en">
  <siteinfo>
    <sitename>Wikipedia</sitename>
    <dbname>enwiki</dbname>
    <base>https://en.wikipedia.org/wiki/Main_Page</base>
    <generator>MediaWiki 1.35.0-wmf.31</generator>
    <case>first-letter</case>
    <namespaces>
      <namespace key="-2" case="first-letter">Media</namespace>
      <namespace key="-1" case="first-letter">Special</namespace>
      <namespace key="0" case="first-letter" />
      <namespace key="1" case="first-letter">Talk</namespace>
      <namespace key="2" case="first-letter">User</namespace>
      <namespace key="3" case="first-letter">User talk</namespace>
      <namespace key="4" case="first-letter">Wikipedia</namespace>
      <namespace key="5" case="first-letter">Wikipedia talk</namespace>
      <namespace key="6" case="first-letter">File</namespace>
      <namespace key="7" case="first-letter">File talk</namespace>
      <namespace key="8" case="first-letter">MediaWiki</namespace>
      <namespace key="9" case="first-letter">MediaWiki talk</namespace>
      <namespace key="10" case="first-letter">Template</namespace>
      <namespace key="11" case="first-letter">Template talk</namespace>
      <namespace key="12" case="first-letter">Help</namespace>
      <namespace key="13" case="first-letter">Help talk</namespace>
      <namespace key="14" case="first-letter">Category</namespace>
      <namespace key="15" case="first-letter">Category talk</namespace>
      <namespace key="100" case="first-letter">Portal</namespace>
      <namespace key="101" case="first-letter">Portal talk</namespace>
      <namespace key="108" case="first-letter">Book</namespace>
      <namespace key="109" case="first-letter">Book talk</namespace>
      <namespace key="118" case="first-letter">Draft</namespace>
      <namespace key="119" case="first-letter">Draft talk</namespace>
      <namespace key="446" case="first-letter">Education Program</namespace>
      <namespace key="447" case="first-letter">Education Program talk</namespace>
      <namespace key="710" case="first-letter">TimedText</namespace>
      <namespace key="711" case="first-letter">TimedText talk</namespace>
      <namespace key="828" case="first-letter">Module</namespace>
      <namespace key="829" case="first-letter">Module talk</namespace>
      <namespace key="2300" case="first-letter">Gadget</namespace>
      <namespace key="2301" case="first-letter">Gadget talk</namespace>
      <namespace key="2302" case="case-sensitive">Gadget definition</namespace>
      <namespace key="2303" case="case-sensitive">Gadget definition talk</namespace>
    </namespaces>
  </siteinfo>
  <page>
    <title>Least-squares spectral analysis</title>
    <ns>0</ns>
    <id>13609399</id>
    <revision>
      <id>947425848</id>
      <parentid>941353571</parentid>
      <timestamp>2020-03-26T06:35:35Z</timestamp>
      <contributor>
        <username>Citation bot</username>
        <id>7903804</id>
      </contributor>
      <minor/>
      <comment>Alter: isbn. Add: year, issue. Removed URL that duplicated unique identifier. | You can [[WP:UCB|use this bot]] yourself. [[WP:DBUG|Report bugs here]]. | Activated by [[User:AManWithNoPlan]] | All pages linked from [[User:AManWithNoPlan/sandbox2]] | via #UCB_webform_linked</comment>
      <model>wikitext</model>
      <format>text/x-wiki</format>
      <text bytes="25399" xml:space="preserve">'''Least-squares spectral analysis (LSSA)''' is a method of estimating a [[frequency spectrum]], based on a [[least squares]] fit of [[Sine wave|sinusoid]]s to data samples, similar to [[Fourier analysis]].&lt;ref&gt;{{cite book | title = Variable Stars As Essential Astrophysical Tools | author = Cafer Ibanoglu | publisher = Springer | year = 2000 | isbn = 0-7923-6084-2 | url = https://books.google.com/books?id=QzGbOiZ3OnkC&amp;pg=PA269&amp;dq=vanicek+spectral+sinusoids }}&lt;/ref&gt;&lt;ref name=birn/&gt; [[Fourier analysis]], the most used spectral method in science, generally boosts long-periodic noise in long gapped records; LSSA mitigates such problems.&lt;ref name=pres&gt;{{cite book | url = https://books.google.com/books?id=9GhDHTLzFDEC&amp;pg=PA685&amp;dq=%22spectral+analysis%22+%22vanicek%22+inauthor:press | author = Press | title = Numerical Recipes | edition = 3rd | year = 2007 | publisher = Cambridge University Press | isbn = 978-0-521-88068-8 }}&lt;/ref&gt;

LSSA is also known as the '''Vaníček method'''&lt;ref name=taha&gt;{{cite journal |author1=J. Taylor |author2=S. Hamilton | title = Some tests of the Vaníček Method of spectral analysis | date = 1972-03-20 | pages = 357–367 | issue = 2 | volume = 17 | journal = Astrophysics and Space Science |doi=10.1007/BF00642907 | bibcode=1972Ap&amp;SS..17..357T}}&lt;/ref&gt; after [[Petr Vaníček]], and as the '''Lomb method'''&lt;ref name=pres/&gt; (or the Lomb periodogram&lt;ref&gt;{{cite book | title = Nonlinear Dynamics and Statistics | author = Alistair I. Mees | publisher = Springer | year = 2001 | isbn = 0-8176-4163-7 | url = https://books.google.com/books?id=pH_OmkD4ZaQC&amp;pg=PA227&amp;dq=Lomb-periodogram  }}&lt;/ref&gt;) and the '''Lomb–Scargle method'''&lt;ref&gt;{{cite book | title = Climate Change: Critical Concepts in the Environment | author = Frank Chambers | publisher = Routledge | year = 2002 | isbn = 0-415-27858-9 | url = https://books.google.com/books?id=LnqFIpFJ9cwC&amp;pg=PA178&amp;dq=Lomb-Scargle-method }}&lt;/ref&gt; (or Lomb–Scargle periodogram&lt;ref name=birn&gt;{{cite book | title = Observational Astronomy |author1=D. Scott Birney |author2=David Oesper |author3=Guillermo Gonzalez | publisher = Cambridge University Press | year = 2006 | isbn = 0-521-85370-2 | url = https://books.google.com/books?id=cc9L8QWcZWsC&amp;pg=RA3-PA263&amp;dq=Lomb-Scargle-periodogram  }}&lt;/ref&gt;&lt;ref&gt;{{cite journal | title = Searching for Biological Rhythms: Peak Detection in the Periodogram of Unequally Spaced Data | author = Hans P. A. Van Dongen | journal = Journal of Biological Rhythms | volume = 14 | issue = 6 | year = 1999 | pages = 617–620 | doi = 10.1177/074873099129000984 | pmid = 10643760 }}&lt;/ref&gt;), based on the contributions of Nicholas R. Lomb&lt;ref name=lomb/&gt; and, independently, Jeffrey D. Scargle.&lt;ref name=scar/&gt;  Closely related methods have been developed by Michael Korenberg and by Scott Chen and [[David Donoho]].

==Historical background==

The close connections between [[Fourier analysis]], the [[periodogram]], and [[least-squares]] fitting of sinusoids have long been known.&lt;ref&gt;{{cite book | title = The Combination of Observations | author = David Brunt | publisher = Cambridge University Press | year = 1931 | edition = 2nd }}&lt;/ref&gt;  Most developments, however, are restricted to complete data sets of equally spaced samples.  In 1963, Freek J. M. Barning of [[Centrum Wiskunde &amp; Informatica|Mathematisch Centrum]], Amsterdam, handled unequally spaced data by similar techniques,&lt;ref&gt;{{cite journal |author1=Barning, F. J. M. |title=The numerical analysis of the light-curve of 12 Lacertae |bibcode=1963BAN....17...22B |year=1963 |pages=22 |volume=17 |journal=Bulletin of the Astronomical Institutes of the Netherlands}}&lt;/ref&gt; including both a periodogram analysis equivalent to what is now referred to the Lomb method, and least-squares fitting of selected frequencies of sinusoids determined from such periodograms, connected by a procedure that is now known as [[matching pursuit]] with post-backfitting&lt;ref name=kmp&gt;{{cite journal | title = Kernel Matching Pursuit |author1=Pascal Vincent |author2=Yoshua Bengio | journal = Machine Learning | volume=48 | pages=165–187 |year=2002 | url = http://www.iro.umontreal.ca/~vincentp/Publications/kmp_mlj.pdf | doi = 10.1023/A:1013955821559 }}&lt;/ref&gt; or orthogonal matching pursuit.&lt;ref&gt;Y. C. Pati, R. Rezaiifar, and P. S. Krishnaprasad, "Orthogonal matching pursuit: Recursive function approximation with applications to wavelet decomposition," in ''Proc. 27th Asilomar Conference on Signals, Systems and Computers,'' A. Singh, ed., Los Alamitos, CA, USA, IEEE Computer Society Press, 1993.&lt;/ref&gt;

[[Petr Vaníček]], a Canadian [[geodesy|geodesist]] of the [[University of New Brunswick]], also proposed the matching-pursuit approach, which he called "successive spectral analysis" and the result a "least-squares periodogram", with equally and unequally spaced data, in 1969.&lt;ref name=vana&gt;{{Cite journal | last1 = Vaníček | first1 = P. | title = Approximate spectral analysis by least-squares fit | doi = 10.1007/BF00651344 | journal = Astrophysics and Space Science | volume = 4 | issue = 4 | pages = 387–391 | year = 1969 | pmid =  | pmc = | bibcode=1969Ap&amp;SS...4..387V}}&lt;/ref&gt; He generalized this method to account for systematic components beyond a simple mean, such as a "predicted linear (quadratic, exponential, ...) secular trend of unknown magnitude", and applied it to a variety of samples, in 1971.&lt;ref name=vanb&gt;{{Cite journal | last1 = Vaníček | first1 = P. | doi = 10.1007/BF00656134 | title = Further development and properties of the spectral analysis by least-squares | journal = Astrophysics and Space Science | volume = 12 | pages = 10–33 | year = 1971 | issue = 1 | pmid =  | pmc = | bibcode=1971Ap&amp;SS..12...10V}}&lt;/ref&gt;

The Vaníček method was then simplified in 1976 by Nicholas R. Lomb of the [[University of Sydney]], who pointed out its close connection to [[periodogram]] analysis.&lt;ref  name=lomb&gt;{{Cite journal | last1 = Lomb | first1 = N. R. | title = Least-squares frequency analysis of unequally spaced data | doi = 10.1007/BF00648343 | journal = Astrophysics and Space Science | volume = 39 | issue = 2 | pages = 447–462 | year = 1976 | pmid =  | pmc = | bibcode=1976Ap&amp;SS..39..447L}}&lt;/ref&gt;  The definition of a periodogram of unequally spaced data was subsequently further modified and analyzed by Jeffrey D. Scargle of [[NASA Ames Research Center]],&lt;ref name=scar&gt;{{cite journal |author1=Scargle, J. D. |bibcode=1982ApJ...263..835S |title=Studies in astronomical time series analysis. II - Statistical aspects of spectral analysis of unevenly spaced data |doi=10.1086/160554 |year=1982 |pages=835 |volume=263 |journal=Astrophysical Journal}}&lt;/ref&gt; who showed that with minor changes it could be made identical to Lomb's least-squares formula for fitting individual sinusoid frequencies.

Scargle states that his paper "does not introduce a new detection technique, but instead studies the reliability and efficiency of detection with the most commonly used technique, the periodogram, in the case where the observation times are [[unevenly spaced time series|unevenly spaced]]," and further points out in reference to least-squares fitting of sinusoids compared to periodogram analysis, that his paper "establishes, apparently for the first time, that (with the proposed modifications) these two methods are exactly equivalent."&lt;ref name=scar/&gt;

Press&lt;ref name=pres/&gt; summarizes the development this way:

{{quote|A completely different method of spectral analysis for unevenly sampled data, one that mitigates these difficulties and has some other very desirable properties, was developed by Lomb, based in part on earlier work by Barning and Vanicek, and additionally elaborated by Scargle.}}

Michael Korenberg of Queen's University in 1989 developed the "fast orthogonal search" method of more quickly finding a near-optimal decomposition of spectra or other problems,&lt;ref name=k89/&gt; similar to the technique that later became known as orthogonal matching pursuit.  In 1994, Scott Chen and David Donoho of Stanford University have developed the "basis pursuit" method using minimization of the [[L1 norm]] of coefficients to cast the problem as a [[linear programming]] problem, for which efficient solutions are available.&lt;ref name=chen/&gt;

==The Vaníček method==

In the Vaníček method, a discrete data set is approximated by a weighted sum of sinusoids of progressively determined frequencies, using a standard [[linear regression]], or [[least-squares]] fit.&lt;ref name=UNB85&gt;Wells, D.E., P. Vaníček, S. Pagiatakis, 1985. Least-squares spectral analysis revisited. Department of Surveying Engineering Technical Report 84, University of New Brunswick, Fredericton, 68 pages, Available at [http://www2.unb.ca/gge/Pubs/TR84.pdf].&lt;/ref&gt;  The frequencies are chosen using a method similar to Barning's, but going further in optimizing the choice of each successive new frequency by picking the frequency that minimizes the residual after least-squares fitting (equivalent to the fitting technique now known as [[matching pursuit]] with pre-backfitting&lt;ref name=kmp/&gt;). The number of sinusoids must be less than or equal to the number of data samples (counting sines and cosines of the same frequency as separate sinusoids).

A data vector ''Φ'' is represented as a weighted sum of sinusoidal basis functions, tabulated in a matrix '''A''' by evaluating each function at the sample times, with weight vector ''x'':

:&lt;math&gt;\phi \approx \textbf{A}x&lt;/math&gt;

where the weight vector ''x'' is chosen to minimize the sum of squared errors in approximating ''Φ''.  The solution for ''x'' is closed-form, using standard [[linear regression]]:&lt;ref name=craymer/&gt;

:&lt;math&gt;x = (\textbf{A}^{\mathrm{T}}\textbf{A})^{-1}\textbf{A}^{\mathrm{T}}\phi.&lt;/math&gt;

Here the matrix A can be based on any set of functions that are mutually independent (not necessarily orthogonal) when evaluated at the sample times; for spectral analysis, the functions used are typically sines and cosines evenly distributed over the frequency range of interest.  If too many frequencies are chosen in a too-narrow frequency range, the functions will not be sufficiently independent, the matrix will be badly conditioned, and the resulting spectrum will not be meaningful.&lt;ref name=craymer/&gt;

When the basis functions in '''A''' are orthogonal (that is, not correlated, meaning the columns have zero pair-wise [[dot product]]s), the matrix '''A&lt;sup&gt;T&lt;/sup&gt;A''' is a diagonal matrix; when the columns all have the same power (sum of squares of elements), then that matrix is an [[identity matrix]] times a constant, so the inversion is trivial.  The latter is the case when the sample times are equally spaced and the sinusoids are chosen to be sines and cosines equally spaced in pairs on the frequency interval 0 to a half cycle per sample (spaced by 1/N cycle per sample, omitting the sine phases at 0 and maximum frequency where they are identically zero).  This particular case is known as the [[discrete Fourier transform]], slightly rewritten in terms of real data and coefficients.&lt;ref name=craymer/&gt;

:&lt;math&gt;x = \textbf{A}^{\mathrm{T}}\phi&lt;/math&gt; &amp;nbsp; &amp;nbsp; (DFT case for ''N'' equally spaced samples and frequencies, within a scalar factor)

Lomb proposed using this simplification in general, except for pair-wise correlations between sine and cosine bases of the same frequency, since the correlations between pairs of sinusoids are often small, at least when they are not too closely spaced.  This is essentially the traditional [[periodogram]] formulation, but now adopted for use with unevenly spaced samples.  The vector ''x'' is a good estimate of an underlying spectrum, but since correlations are ignored, '''A'''''x'' is no longer a good approximation to the signal, and the method is no longer a least-squares method – yet it has continued to be referred to as such.

==The Lomb–Scargle periodogram==

Rather than just taking dot products of the data with sine and cosine waveforms directly, Scargle modified the standard periodogram formula to first find a time delay τ such that this pair of sinusoids would be mutually orthogonal at sample times ''t&lt;sub&gt;j&lt;/sub&gt;'', and also adjusted for the potentially unequal powers of these two basis functions, to obtain a better estimate of the power at a frequency,&lt;ref name=pres/&gt;&lt;ref name=scar/&gt; which made his modified periodogram method exactly equivalent to Lomb's least-squares method. The time delay τ is defined by the formula

:&lt;math&gt;\tan{2 \omega \tau} = \frac{\sum_j \sin 2 \omega t_j}{\sum_j \cos 2 \omega t_j}.
&lt;/math&gt;

The periodogram at frequency ω is then estimated as:

:&lt;math&gt;P_x(\omega) = \frac{1}{2} 
\left(
  \frac { \left[ \sum_j X_j \cos \omega ( t_j - \tau ) \right] ^ 2}
        { \sum_j \cos^2 \omega ( t_j - \tau ) }
+
 \frac {\left[ \sum_j X_j \sin \omega ( t_j - \tau ) \right] ^ 2}
        { \sum_j \sin^2 \omega ( t_j - \tau ) }
\right) &lt;/math&gt;

which Scargle reports then has the same statistical distribution as the periodogram in the evenly sampled case.&lt;ref name=scar/&gt;

At any individual frequency ω, this method gives the same power as does a least-squares fit to sinusoids of that frequency, of the form

:&lt;math&gt;\phi(t) = A \sin \omega t + B \cos \omega t.&lt;/math&gt;&lt;ref&gt;{{cite book | title = Data Analysis Methods in Physical Oceanography |author1=William J. Emery |author2=Richard E. Thomson | publisher = Elsevier | year = 2001 | isbn = 0-444-50756-6 | url = https://books.google.com/books?id=gYc4fp_ixmwC&amp;pg=PA458&amp;dq=vanicek+least-squares+spectral-analysis+lomb }}&lt;/ref&gt;

==The generalized Lomb–Scargle periodogram==
The standard Lomb–Scargle periodogram is valid for a model with zero mean. Commonly, this is approximated by subtracting the mean of the data before calculating the periodogram. However, this is an inaccurate assumption when the mean of the model (the fitted sinusoids) is non-zero. The ''generalized'' Lomb–Scargle periodogram removes this assumption, and explicitly solves for the mean. In this case, the function fitted is

:&lt;math&gt;\phi(t) = A \sin \omega t + B \cos \omega t + C.&lt;/math&gt;&lt;ref&gt;{{cite journal |author1=M. Zechmeister |author2=M. Kürster | title = The generalised Lomb–Scargle periodogram. A new formalism for the floating-mean and Keplerian periodograms | journal = Astronomy &amp; Astrophysics | date = March 2009 | volume = 496 | issue = 2 | pages = 577–584 | doi = 10.1051/0004-6361:200811296 | bibcode = 2009A&amp;A...496..577Z | arxiv = 0901.2573 }}&lt;/ref&gt;

The generalized Lomb–Scargle periodogram has also been referred to as a ''floating mean periodogram''.&lt;ref&gt;{{cite journal | author1 = Andrew Cumming | author2 = Geoffrey W. Marcy | author3 = R. Paul Butler | title = The Lick Planet Search: Detectability and Mass Thresholds | journal = The Astrophysical Journal | date = December 1999 | volume = 526 | issue = 2 | pages = 890–915 | doi = 10.1086/308020 | bibcode = 1999ApJ...526..890C | arxiv = astro-ph/9906466 }}&lt;/ref&gt;

==Korenberg's "fast orthogonal search" method==

Michael Korenberg of [[Queen's University at Kingston|Queen's University]] in [[Kingston, Ontario]], developed a method for choosing a sparse set of components from an over-complete set, such as sinusoidal components for spectral analysis, called fast orthogonal search (FOS).  Mathematically, FOS uses a slightly modified [[Cholesky decomposition]] in a mean-square error reduction (MSER) process, implemented as a [[sparse matrix]] inversion.&lt;ref name=k89&gt;{{cite journal | author = Korenberg, M. J. | title = A robust orthogonal algorithm for system identification and time-series analysis | journal = Biological Cybernetics | volume = 60 | pages = 267–276 | year = 1989 | doi = 10.1007/BF00204124 | pmid = 2706281 | issue = 4}}&lt;/ref&gt;&lt;ref&gt;{{cite journal | title = Raman Spectral Estimation via Fast Orthogonal Search | journal = The Analyst | year = 1997 | volume = 122 | issue = 9 | pages = 879–882 | doi = 10.1039/a700902j | author = Korenberg, Michael J. | last2 = Brenan | first2 = Colin J. H. | last3 = Hunter | first3 = Ian W.|bibcode = 1997Ana...122..879K }}&lt;/ref&gt;  As with the other LSSA methods, FOS avoids the major shortcoming of discrete Fourier analysis, and can achieve highly accurate identifications of embedded periodicities and excels with unequally spaced data; the fast orthogonal search method has also been applied to other problems such as nonlinear system identification.

==Chen and Donoho's "basis pursuit" method==

Chen and Donoho have developed a procedure called [[basis pursuit]] for fitting a sparse set of sinusoids or other functions from an over-complete set.  The method defines an optimal solution as the one that minimizes the [[L1 norm]] of the coefficients, so that the problem can be cast as a [[linear programming]] problem, for which efficient solution methods are available.&lt;ref name=chen&gt;S. Chen and [[David Donoho|D.L. Donoho]] (1994), "Basis Pursuit." Technical Report, Department of Statistics, Stanford University, Available at [http://statweb.stanford.edu/~donoho/Reports/1994/asilomar.pdf] {{Webarchive|url=https://web.archive.org/web/20170705154725/http://statweb.stanford.edu/~donoho/Reports/1994/asilomar.pdf |date=2017-07-05 }}&lt;/ref&gt;

==Palmer's Chi-squared method==

Palmer has developed a method for finding the best-fit function to any chosen number of harmonics, allowing more freedom to find non-sinusoidal harmonic functions.&lt;ref name="fastchi2"&gt;{{cite journal
 | last=Palmer
 | first=David M.
 | title = A Fast Chi-squared Technique For Period Search of Irregularly Sampled Data
 | arxiv=0901.1913
 | doi=10.1088/0004-637X/695/1/496
 | bibcode=2009ApJ...695..496P
 | volume=695
 | journal=The Astrophysical Journal
 | year=2009
 | issue=1
 | pages=496–502
 }}&lt;/ref&gt; 
This method is a fast technique ([[Fast Fourier transform|FFT]]-based) for doing [[Least-squares analysis#Weighted least squares|weighted least-squares analysis]] on arbitrarily spaced data with non-uniform standard errors.  Source code that implements this technique is available.&lt;ref&gt;
{{cite web 
 | url = http://public.lanl.gov/palmer/fastchi.html
 | title = David Palmer: The Fast Chi-squared Period Search
 }}&lt;/ref&gt;
Because data are often not sampled at uniformly spaced discrete times, this method "grids" the data by sparsely filling a time series array at the sample times.  All intervening grid points receive zero statistical weight, equivalent to having infinite error bars at times between samples.

==Applications==

The most useful feature of the LSSA method is enabling incomplete records to be [[frequency spectrum|spectrally]] analyzed, without the need to [[Data manipulation|manipulate]] the record or to invent otherwise non-existent data.

[[magnitude (mathematics)|Magnitude]]s in the LSSA [[frequency spectrum|spectrum]] depict the contribution of a frequency or period to the [[variance]] of the [[time series]].&lt;ref name=vana/&gt; Generally, spectral magnitudes defined in the above manner enable the output's straightforward [[significance level]] regime.&lt;ref name=bwmm&gt;Beard, A.G., Williams, P.J.S., Mitchell, N.J. &amp; Muller, H.G.  A special climatology of planetary waves and tidal variability, J Atm. Solar-Ter. Phys. 63 (09), p.801–811 (2001).&lt;/ref&gt;  Alternatively, magnitudes in the Vaníček spectrum can also be expressed in [[decibel|dB]].&lt;ref name=pagi&gt;Pagiatakis, S. Stochastic significance of peaks in the least-squares spectrum, J of Geodesy 73, p.67-78 (1999).&lt;/ref&gt;  Note that magnitudes in the Vaníček spectrum follow [[beta distribution|β-distribution]].&lt;ref&gt;Steeves, R.R. A statistical test for significance of peaks in the least squares spectrum, Collected Papers of the Geodetic Survey, Department of Energy, Mines and Resources, Surveys and Mapping, Ottawa, Canada, p.149-166 (1981)&lt;/ref&gt;

[[Inverse transformation]] of Vaníček's LSSA is possible, as is most easily seen by writing the forward transform as a matrix; the matrix inverse (when the matrix is not singular) or pseudo-inverse will then be an inverse transformation; the inverse will exactly match the original data if the chosen sinusoids are mutually independent at the sample points and their number is equal to the number of data points.&lt;ref name=craymer&gt;Craymer, M.R., [ftp://ftp.geod.nrcan.gc.ca/pub/GSD/craymer/pubs/thesis1998.pdf ''The Least Squares Spectrum, Its Inverse Transform and Autocorrelation Function: Theory and Some Applications in Geodesy'']{{dead link|date=December 2017 |bot=InternetArchiveBot |fix-attempted=yes }}, Ph.D. Dissertation, University of Toronto, Canada (1998).&lt;/ref&gt;  No such inverse procedure is known for the periodogram method.

==Implementation==

The LSSA can be implemented in less than a page of [[MATLAB]] code.&lt;ref&gt;{{cite book | title = Ice Ages and Astronomical Causes: Data, Spectral Analysis, and Mechanisms |author1=Richard A. Muller |author2=Gordon J. MacDonald | publisher = Springer | year = 2000 | isbn = 3-540-43779-7 | url = https://books.google.com/books?id=P8ideTkMQisC&amp;pg=PA289&amp;dq=spectral+lomb+scargle }}&lt;/ref&gt; In essence:&lt;ref name=UNB85/&gt;
&lt;blockquote&gt;
"to compute the least-squares spectrum we must compute ''m'' spectral values ... which involves performing the least-squares approximation ''m'' times, each time to get [the spectral power] for a different frequency"
&lt;/blockquote&gt;
I.e., for each frequency in a desired set of frequencies, [[sine]] and [[cosine]] functions are evaluated at the times corresponding to the data samples, and [[dot product]]s of the data [[coordinate vector|vector]] with the sinusoid vectors are taken and appropriately normalized; following the method known as Lomb/Scargle periodogram, a time shift is calculated for each frequency to orthogonalize the sine and cosine components before the dot product, as described by Craymer;&lt;ref name=craymer/&gt; finally, a power is computed from those two [[amplitude]] components.  This same process implements a [[discrete Fourier transform]] when the data are uniformly spaced in time and the frequencies chosen correspond to integer numbers of cycles over the finite data record.

This method treats each sinusoidal component independently, or out of context, even though they may not be orthogonal on the data points; it is Vaníček's original method. In contrast, as Craymer explains, it is also possible to perform a full simultaneous or in-context least-squares fit by solving a matrix equation, partitioning the total data variance between the specified sinusoid frequencies.&lt;ref name=craymer/&gt; Such a matrix least-squares solution is natively available in MATLAB as the [[backslash]] operator.&lt;ref&gt;{{cite book | title = MATLAB Primer |author1=Timothy A. Davis |author2=Kermit Sigmon | publisher = CRC Press | year = 2005 | isbn = 1-58488-523-8 | url = https://books.google.com/books?id=MXWypqcHECkC&amp;pg=PA12&amp;dq=matlab+least-squares+backslash }}&lt;/ref&gt;

Craymer explains that the simultaneous or in-context method, as opposed to the independent or out-of-context version (as well as the periodogram version due to Lomb), cannot fit more components (sines and cosines) than there are data samples, and further that:&lt;ref name=craymer/&gt;

{{quote|"...serious repercussions can also arise if the selected frequencies result in some of the Fourier components (trig functions) becoming nearly linearly dependent with each other, thereby producing an ill-conditioned or near singular N.  To avoid such ill conditioning it becomes necessary to either select a different set of frequencies to be estimated (e.g., equally spaced frequencies) or simply neglect the correlations in N (i.e., the off-diagonal blocks) and estimate the inverse least squares transform separately for the individual frequencies..."}}

Lomb's periodogram method, on the other hand, can use an arbitrarily high number of, or density of, frequency components, as in a standard [[periodogram]]; that is, the frequency domain can be over-sampled by an arbitrary factor.&lt;ref name=pres/&gt;

In Fourier analysis, such as the [[Fourier transform]] or the [[discrete Fourier transform]], the sinusoids being fitted to the data are all mutually orthogonal, so there is no distinction between the simple out-of-context dot-product-based projection onto basis functions versus an in-context simultaneous least-squares fit; that is, no matrix inversion is required to least-squares partition the variance between orthogonal sinusoids of different frequencies.&lt;ref&gt;{{cite book | title = Discrete-Time Signal Processing: An Algebraic Approach | author = Darrell Williamson | publisher = Springer | year = 1999 | isbn = 1-85233-161-5 | url = https://books.google.com/books?id=JCKAirWQdqkC&amp;pg=PA314&amp;dq=fourier-transform+orthogonal+least-squares }}&lt;/ref&gt;  This method is usually preferred for its efficient [[fast Fourier transform]] implementation, when complete data records with equally spaced samples are available.

==See also==

* [[Orthogonal functions]]
* [[Sinusoidal model]]
* [[Spectral density]]
* [[Spectral density estimation]], for competing alternatives

==References==

{{reflist}}

==External links==
* [ftp://ftp.geod.nrcan.gc.ca/pub/GSD/craymer/software/lssa/ LSSA software freeware download]{{dead link|date=December 2017 |bot=InternetArchiveBot |fix-attempted=yes }} (via ftp), FORTRAN, Vaníček's method, from the [[Natural Resources Canada]].

[[Category:Digital signal processing]]
[[Category:Frequency-domain analysis]]</text>
      <sha1>ry0uhmzn6wz6srjjqrhrlrf39pxw9jr</sha1>
    </revision>
  </page>
</mediawiki>
